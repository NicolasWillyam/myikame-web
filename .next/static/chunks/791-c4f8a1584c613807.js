"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[791],{4131:function(e,t,o){function r(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)e[r]=o[r]}return e}o.d(t,{Z:function(){return n}});var n=function e(t,o){function n(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=r({},o,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var s in i)i[s]&&(a+="; "+s,!0!==i[s]&&(a+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+a}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var o=document.cookie?document.cookie.split("; "):[],r={},n=0;n<o.length;n++){var i=o[n].split("="),a=i.slice(1).join("=");try{var s=decodeURIComponent(i[0]);if(r[s]=t.read(a,s),e===s)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){n(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(o)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},9658:function(e,t){async function o(e){let t=new TextEncoder().encode(e);if("undefined"==typeof crypto||void 0===crypto.subtle)throw Error("Web Crypto API is not available.");return await crypto.subtle.digest("SHA-256",t)}function r(e){let t;let[o,r]=e.split(".");if("string"!=typeof r)throw Error("Unable to decode token, payload not found.");try{t=function(e){let t=e.replaceAll("-","+").replaceAll("_","/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("Input is not of the correct length.")}try{var o;return o=t,decodeURIComponent(atob(o).replace(/(.)/g,(e,t)=>{let o=t.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}catch(e){return atob(t)}}(r)}catch(e){throw Error("Unable to decode token, payload is not a valid Base64URL value.",{cause:e})}try{return JSON.parse(t)}catch(e){throw Error("Unable to decode token, payload is not a valid JSON value.",{cause:e})}}function n(e){return"object"==typeof e&&null!==e}t.Z=function e(t){if(!(this instanceof e))throw Error("The 'Keycloak' constructor must be invoked with 'new'.");if("string"!=typeof t&&!n(t))throw Error("The 'Keycloak' constructor must be provided with a configuration object, or a URL to a JSON configuration file.");if(n(t)){for(let e of"oidcProvider"in t?["clientId"]:["url","realm","clientId"])if(!t[e])throw Error(`The configuration object is missing the required '${e}' property.`)}var i,a,s=this,c=[],u={enable:!0,callbackList:[],interval:5};s.didInitialize=!1;var d=!0,l=E(console.info),p=E(console.warn);async function f(e,t){if("S256"!==e)throw TypeError(`Invalid value for 'pkceMethod', expected 'S256' but got '${e}'.`);return btoa(String.fromCodePoint(...new Uint8Array(await o(t)))).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}function h(){return void 0===s.authServerUrl?void 0:"/"==s.authServerUrl.charAt(s.authServerUrl.length-1)?s.authServerUrl+"realms/"+encodeURIComponent(s.realm):s.authServerUrl+"/realms/"+encodeURIComponent(s.realm)}function m(e,t){var o=e.code,r=e.error,n=e.prompt,i=new Date().getTime();if(e.kc_action_status&&s.onActionUpdate&&s.onActionUpdate(e.kc_action_status,e.kc_action),r){if("none"!=n){if(e.error_description&&"authentication_expired"===e.error_description)s.login(e.loginOptions);else{var a={error:r,error_description:e.error_description};s.onAuthError&&s.onAuthError(a),t&&t.setError(a)}}else t&&t.setSuccess();return}if("standard"!=s.flow&&(e.access_token||e.id_token)&&f(e.access_token,null,e.id_token,!0),"implicit"!=s.flow&&o){var c="code="+o+"&grant_type=authorization_code",u=s.endpoints.token(),p=new XMLHttpRequest;p.open("POST",u,!0),p.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c+="&client_id="+encodeURIComponent(s.clientId)+"&redirect_uri="+e.redirectUri,e.pkceCodeVerifier&&(c+="&code_verifier="+e.pkceCodeVerifier),p.withCredentials=!0,p.onreadystatechange=function(){if(4==p.readyState){if(200==p.status){var e=JSON.parse(p.responseText);f(e.access_token,e.refresh_token,e.id_token,"standard"===s.flow),U()}else s.onAuthError&&s.onAuthError(),t&&t.setError()}},p.send(c)}function f(o,r,n,a){k(o,r,n,i=(i+new Date().getTime())/2),d&&s.idTokenParsed&&s.idTokenParsed.nonce!=e.storedNonce?(l("[KEYCLOAK] Invalid nonce, clearing token"),s.clearToken(),t&&t.setError()):a&&(s.onAuthSuccess&&s.onAuthSuccess(),t&&t.setSuccess())}}function g(e){return 0==e.status&&e.responseText&&e.responseURL.startsWith("file:")}function k(e,t,o,n){if(s.tokenTimeoutHandle&&(clearTimeout(s.tokenTimeoutHandle),s.tokenTimeoutHandle=null),t?(s.refreshToken=t,s.refreshTokenParsed=r(t)):(delete s.refreshToken,delete s.refreshTokenParsed),o?(s.idToken=o,s.idTokenParsed=r(o)):(delete s.idToken,delete s.idTokenParsed),e){if(s.token=e,s.tokenParsed=r(e),s.sessionId=s.tokenParsed.sid,s.authenticated=!0,s.subject=s.tokenParsed.sub,s.realmAccess=s.tokenParsed.realm_access,s.resourceAccess=s.tokenParsed.resource_access,n&&(s.timeSkew=Math.floor(n/1e3)-s.tokenParsed.iat),null!=s.timeSkew&&(l("[KEYCLOAK] Estimated time difference between browser and server is "+s.timeSkew+" seconds"),s.onTokenExpired)){var i=(s.tokenParsed.exp-new Date().getTime()/1e3+s.timeSkew)*1e3;l("[KEYCLOAK] Token expires in "+Math.round(i/1e3)+" s"),i<=0?s.onTokenExpired():s.tokenTimeoutHandle=setTimeout(s.onTokenExpired,i)}}else delete s.token,delete s.tokenParsed,delete s.subject,delete s.realmAccess,delete s.resourceAccess,s.authenticated=!1}function v(){if("undefined"==typeof crypto||void 0===crypto.randomUUID)throw Error("Web Crypto API is not available.");return crypto.randomUUID()}function w(e){var t=function(e){switch(s.flow){case"standard":t=["code","state","session_state","kc_action_status","kc_action","iss"];break;case"implicit":t=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status","kc_action","iss"];break;case"hybrid":t=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status","kc_action","iss"]}t.push("error"),t.push("error_description"),t.push("error_uri");var t,o,r,n=e.indexOf("?"),i=e.indexOf("#");if("query"===s.responseMode&&-1!==n?(o=e.substring(0,n),""!==(r=b(e.substring(n+1,-1!==i?i:e.length),t)).paramsString&&(o+="?"+r.paramsString),-1!==i&&(o+=e.substring(i))):"fragment"===s.responseMode&&-1!==i&&(o=e.substring(0,i),""!==(r=b(e.substring(i+1),t)).paramsString&&(o+="#"+r.paramsString)),r&&r.oauthParams){if("standard"===s.flow||"hybrid"===s.flow){if((r.oauthParams.code||r.oauthParams.error)&&r.oauthParams.state)return r.oauthParams.newUrl=o,r.oauthParams}else if("implicit"===s.flow&&(r.oauthParams.access_token||r.oauthParams.error)&&r.oauthParams.state)return r.oauthParams.newUrl=o,r.oauthParams}}(e);if(t){var o=a.get(t.state);return o&&(t.valid=!0,t.redirectUri=o.redirectUri,t.storedNonce=o.nonce,t.prompt=o.prompt,t.pkceCodeVerifier=o.pkceCodeVerifier,t.loginOptions=o.loginOptions),t}}function b(e,t){for(var o=e.split("&"),r={paramsString:"",oauthParams:{}},n=0;n<o.length;n++){var i=o[n].indexOf("="),a=o[n].slice(0,i);-1!==t.indexOf(a)?r.oauthParams[a]=o[n].slice(i+1):(""!==r.paramsString&&(r.paramsString+="&"),r.paramsString+=o[n])}return r}function y(){var e={setSuccess:function(t){e.resolve(t)},setError:function(t){e.reject(t)}};return e.promise=new Promise(function(t,o){e.resolve=t,e.reject=o}),e}function S(){var e=y();if(!u.enable||u.iframe)return e.setSuccess(),e.promise;var t=document.createElement("iframe");u.iframe=t,t.onload=function(){var t=s.endpoints.authorize();"/"===t.charAt(0)?u.iframeOrigin=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""):u.iframeOrigin=t.substring(0,t.indexOf("/",8)),e.setSuccess()};var o=s.endpoints.checkSessionIframe();return t.setAttribute("src",o),t.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),t.setAttribute("title","keycloak-session-iframe"),t.style.display="none",document.body.appendChild(t),window.addEventListener("message",function(e){if(e.origin===u.iframeOrigin&&u.iframe.contentWindow===e.source&&("unchanged"==e.data||"changed"==e.data||"error"==e.data)){"unchanged"!=e.data&&s.clearToken();for(var t=u.callbackList.splice(0,u.callbackList.length),o=t.length-1;o>=0;--o){var r=t[o];"error"==e.data?r.setError():r.setSuccess("unchanged"==e.data)}}},!1),e.promise}function U(){u.enable&&s.token&&setTimeout(function(){_().then(function(e){e&&U()})},1e3*u.interval)}function _(){var e=y();if(u.iframe&&u.iframeOrigin){var t=s.clientId+" "+(s.sessionId?s.sessionId:"");u.callbackList.push(e);var o=u.iframeOrigin;1==u.callbackList.length&&u.iframe.contentWindow.postMessage(t,o)}else e.setSuccess();return e.promise}function C(e){if(!e||"default"==e)return{login:async function(e){return window.location.assign(await s.createLoginUrl(e)),y().promise},logout:async function(e){if("GET"===(e?.logoutMethod??s.logoutMethod)){window.location.replace(s.createLogoutUrl(e));return}let t=s.createLogoutUrl(e),o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id_token_hint:s.idToken,client_id:s.clientId,post_logout_redirect_uri:i.redirectUri(e,!1)})});if(o.redirected){window.location.href=o.url;return}if(o.ok){window.location.reload();return}throw Error("Logout failed, request returned an error code.")},register:function(e){return window.location.assign(s.createRegisterUrl(e)),y().promise},accountManagement:function(){var e=s.createAccountUrl();if(void 0!==e)window.location.href=e;else throw"Not supported by the OIDC server";return y().promise},redirectUri:function(e,t){return e&&e.redirectUri?e.redirectUri:s.redirectUri?s.redirectUri:location.href}};if("cordova"==e){u.enable=!1;var t=function(e,t,o){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(e,t,o):window.open(e,t,o)},o=function(e){var t=e&&e.cordovaOptions?Object.keys(e.cordovaOptions).reduce(function(t,o){return t[o]=e.cordovaOptions[o],t},{}):{};return t.location="no",e&&"none"==e.prompt&&(t.hidden="yes"),Object.keys(t).reduce(function(e,o){return e.push(o+"="+t[o]),e},[]).join(",")},r=function(){return s.redirectUri||"http://localhost"};return{login:async function(e){var n=y(),i=o(e),a=t(await s.createLoginUrl(e),"_blank",i),c=!1,u=!1,d=function(){u=!0,a.close()};return a.addEventListener("loadstart",function(e){0==e.url.indexOf(r())&&(m(w(e.url),n),d(),c=!0)}),a.addEventListener("loaderror",function(e){c||(0==e.url.indexOf(r())?(m(w(e.url),n),d(),c=!0):(n.setError(),d()))}),a.addEventListener("exit",function(e){u||n.setError({reason:"closed_by_user"})}),n.promise},logout:function(e){var o,n=y(),i=t(s.createLogoutUrl(e),"_blank","location=no,hidden=yes,clearcache=yes");return i.addEventListener("loadstart",function(e){0==e.url.indexOf(r())&&i.close()}),i.addEventListener("loaderror",function(e){0==e.url.indexOf(r())||(o=!0),i.close()}),i.addEventListener("exit",function(e){o?n.setError():(s.clearToken(),n.setSuccess())}),n.promise},register:function(e){var n=y(),i=t(s.createRegisterUrl(),"_blank",o(e));return i.addEventListener("loadstart",function(e){0==e.url.indexOf(r())&&(i.close(),m(w(e.url),n))}),n.promise},accountManagement:function(){var e=s.createAccountUrl();if(void 0!==e){var o=t(e,"_blank","location=no");o.addEventListener("loadstart",function(e){0==e.url.indexOf(r())&&o.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(e){return r()}}}if("cordova-native"==e)return u.enable=!1,{login:async function(e){var t=y(),o=await s.createLoginUrl(e);return universalLinks.subscribe("keycloak",function(e){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),m(w(e.url),t)}),window.cordova.plugins.browsertab.openUrl(o),t.promise},logout:function(e){var t=y(),o=s.createLogoutUrl(e);return universalLinks.subscribe("keycloak",function(e){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),s.clearToken(),t.setSuccess()}),window.cordova.plugins.browsertab.openUrl(o),t.promise},register:function(e){var t=y(),o=s.createRegisterUrl(e);return universalLinks.subscribe("keycloak",function(e){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),m(w(e.url),t)}),window.cordova.plugins.browsertab.openUrl(o),t.promise},accountManagement:function(){var e=s.createAccountUrl();if(void 0!==e)window.cordova.plugins.browsertab.openUrl(e);else throw"Not supported by the OIDC server"},redirectUri:function(e){return e&&e.redirectUri?e.redirectUri:s.redirectUri?s.redirectUri:"http://localhost"}};throw"invalid adapter type: "+e}globalThis.isSecureContext||p("[KEYCLOAK] Keycloak JS must be used in a 'secure context' to function properly as it relies on browser APIs that are otherwise not available.\nContinuing to run your application insecurely will lead to unexpected behavior and breakage.\n\nFor more information see: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts"),s.init=function(e){if(s.didInitialize)throw Error("A 'Keycloak' instance can only be initialized once.");if(s.didInitialize=!0,s.authenticated=!1,a=function(){try{return new I}catch(e){}return new T}(),i=e&&["default","cordova","cordova-native"].indexOf(e.adapter)>-1?C(e.adapter):e&&"object"==typeof e.adapter?e.adapter:window.Cordova||window.cordova?C("cordova"):C(),e){if(void 0!==e.useNonce&&(d=e.useNonce),void 0!==e.checkLoginIframe&&(u.enable=e.checkLoginIframe),e.checkLoginIframeInterval&&(u.interval=e.checkLoginIframeInterval),"login-required"===e.onLoad&&(s.loginRequired=!0),e.responseMode){if("query"===e.responseMode||"fragment"===e.responseMode)s.responseMode=e.responseMode;else throw"Invalid value for responseMode"}if(e.flow){switch(e.flow){case"standard":s.responseType="code";break;case"implicit":s.responseType="id_token token";break;case"hybrid":s.responseType="code id_token token";break;default:throw"Invalid value for flow"}s.flow=e.flow}if(null!=e.timeSkew&&(s.timeSkew=e.timeSkew),e.redirectUri&&(s.redirectUri=e.redirectUri),e.silentCheckSsoRedirectUri&&(s.silentCheckSsoRedirectUri=e.silentCheckSsoRedirectUri),"boolean"==typeof e.silentCheckSsoFallback?s.silentCheckSsoFallback=e.silentCheckSsoFallback:s.silentCheckSsoFallback=!0,void 0!==e.pkceMethod){if("S256"!==e.pkceMethod&&!1!==e.pkceMethod)throw TypeError(`Invalid value for pkceMethod', expected 'S256' or false but got ${e.pkceMethod}.`);s.pkceMethod=e.pkceMethod}else s.pkceMethod="S256";"boolean"==typeof e.enableLogging?s.enableLogging=e.enableLogging:s.enableLogging=!1,"POST"===e.logoutMethod?s.logoutMethod="POST":s.logoutMethod="GET","string"==typeof e.scope&&(s.scope=e.scope),"string"==typeof e.acrValues&&(s.acrValues=e.acrValues),"number"==typeof e.messageReceiveTimeout&&e.messageReceiveTimeout>0?s.messageReceiveTimeout=e.messageReceiveTimeout:s.messageReceiveTimeout=1e4}s.responseMode||(s.responseMode="fragment"),s.responseType||(s.responseType="code",s.flow="standard");var o=y(),r=y();r.promise.then(function(){s.onReady&&s.onReady(s.authenticated),o.setSuccess(s.authenticated)}).catch(function(e){o.setError(e)});var n=function(){var e=y();function o(e){e?s.endpoints={authorize:function(){return e.authorization_endpoint},token:function(){return e.token_endpoint},logout:function(){if(!e.end_session_endpoint)throw"Not supported by the OIDC server";return e.end_session_endpoint},checkSessionIframe:function(){if(!e.check_session_iframe)throw"Not supported by the OIDC server";return e.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!e.userinfo_endpoint)throw"Not supported by the OIDC server";return e.userinfo_endpoint}}:s.endpoints={authorize:function(){return h()+"/protocol/openid-connect/auth"},token:function(){return h()+"/protocol/openid-connect/token"},logout:function(){return h()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){return h()+"/protocol/openid-connect/login-status-iframe.html"},thirdPartyCookiesIframe:function(){return h()+"/protocol/openid-connect/3p-cookies/step1.html"},register:function(){return h()+"/protocol/openid-connect/registrations"},userinfo:function(){return h()+"/protocol/openid-connect/userinfo"}}}if("string"==typeof t&&(i=t),i){var r=new XMLHttpRequest;r.open("GET",i,!0),r.setRequestHeader("Accept","application/json"),r.onreadystatechange=function(){if(4==r.readyState){if(200==r.status||g(r)){var t=JSON.parse(r.responseText);s.authServerUrl=t["auth-server-url"],s.realm=t.realm,s.clientId=t.resource,o(null),e.setSuccess()}else e.setError()}},r.send()}else{s.clientId=t.clientId;var n=t.oidcProvider;if(n){if("string"==typeof n){a="/"==n.charAt(n.length-1)?n+".well-known/openid-configuration":n+"/.well-known/openid-configuration";var i,a,r=new XMLHttpRequest;r.open("GET",a,!0),r.setRequestHeader("Accept","application/json"),r.onreadystatechange=function(){4==r.readyState&&(200==r.status||g(r)?(o(JSON.parse(r.responseText)),e.setSuccess()):e.setError())},r.send()}else o(n),e.setSuccess()}else s.authServerUrl=t.url,s.realm=t.realm,o(null),e.setSuccess()}return e.promise}();function c(){var t=function(t){t||(n.prompt="none"),e&&e.locale&&(n.locale=e.locale),s.login(n).then(function(){r.setSuccess()}).catch(function(e){r.setError(e)})},o=async function(){var e=document.createElement("iframe"),t=await s.createLoginUrl({prompt:"none",redirectUri:s.silentCheckSsoRedirectUri});e.setAttribute("src",t),e.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),e.setAttribute("title","keycloak-silent-check-sso"),e.style.display="none",document.body.appendChild(e);var o=function(t){t.origin===window.location.origin&&e.contentWindow===t.source&&(m(w(t.data),r),document.body.removeChild(e),window.removeEventListener("message",o))};window.addEventListener("message",o)},n={};switch(e.onLoad){case"check-sso":u.enable?S().then(function(){_().then(function(e){e?r.setSuccess():s.silentCheckSsoRedirectUri?o():t(!1)}).catch(function(e){r.setError(e)})}):s.silentCheckSsoRedirectUri?o():t(!1);break;case"login-required":t(!0);break;default:throw"Invalid value for onLoad"}}function l(){var t=w(window.location.href);if(t&&window.history.replaceState(window.history.state,null,t.newUrl),t&&t.valid)return S().then(function(){m(t,r)}).catch(function(e){r.setError(e)});e?e.token&&e.refreshToken?(k(e.token,e.refreshToken,e.idToken),u.enable?S().then(function(){_().then(function(e){e?(s.onAuthSuccess&&s.onAuthSuccess(),r.setSuccess(),U()):r.setSuccess()}).catch(function(e){r.setError(e)})}):s.updateToken(-1).then(function(){s.onAuthSuccess&&s.onAuthSuccess(),r.setSuccess()}).catch(function(t){s.onAuthError&&s.onAuthError(),e.onLoad?c():r.setError(t)})):e.onLoad?c():r.setSuccess():r.setSuccess()}return n.then(function(){(function(){var e,t,o,r,n=y();if(u.enable||s.silentCheckSsoRedirectUri){var i=document.createElement("iframe");i.setAttribute("src",s.endpoints.thirdPartyCookiesIframe()),i.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),i.setAttribute("title","keycloak-3p-check-iframe"),i.style.display="none",document.body.appendChild(i);var a=function(e){i.contentWindow===e.source&&("supported"===e.data||"unsupported"===e.data)&&("unsupported"===e.data&&(p("[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:\n\n - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).\n - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).\n\nFor more information see: https://www.keycloak.org/docs/latest/securing_apps/#_modern_browsers"),u.enable=!1,s.silentCheckSsoFallback&&(s.silentCheckSsoRedirectUri=!1)),document.body.removeChild(i),window.removeEventListener("message",a),n.setSuccess())};window.addEventListener("message",a,!1)}else n.setSuccess();return e=n.promise,t=s.messageReceiveTimeout,o="Timeout when waiting for 3rd party check iframe message.",r=null,Promise.race([e,new Promise(function(e,n){r=setTimeout(function(){n({error:o||"Promise is not settled within timeout of "+t+"ms"})},t)})]).finally(function(){clearTimeout(r)})})().then(l).catch(function(e){o.setError(e)})}),n.catch(function(e){o.setError(e)}),o.promise},s.login=function(e){return i.login(e)},s.createLoginUrl=async function(e){var t,o=v(),r=v(),n=i.redirectUri(e),c={state:o,nonce:r,redirectUri:encodeURIComponent(n),loginOptions:e};e&&e.prompt&&(c.prompt=e.prompt),t=e&&"register"==e.action?s.endpoints.register():s.endpoints.authorize();var u=e&&e.scope||s.scope;u?-1===u.indexOf("openid")&&(u="openid "+u):u="openid";var l=t+"?client_id="+encodeURIComponent(s.clientId)+"&redirect_uri="+encodeURIComponent(n)+"&state="+encodeURIComponent(o)+"&response_mode="+encodeURIComponent(s.responseMode)+"&response_type="+encodeURIComponent(s.responseType)+"&scope="+encodeURIComponent(u);if(d&&(l=l+"&nonce="+encodeURIComponent(r)),e&&e.prompt&&(l+="&prompt="+encodeURIComponent(e.prompt)),e&&"number"==typeof e.maxAge&&(l+="&max_age="+encodeURIComponent(e.maxAge)),e&&e.loginHint&&(l+="&login_hint="+encodeURIComponent(e.loginHint)),e&&e.idpHint&&(l+="&kc_idp_hint="+encodeURIComponent(e.idpHint)),e&&e.action&&"register"!=e.action&&(l+="&kc_action="+encodeURIComponent(e.action)),e&&e.locale&&(l+="&ui_locales="+encodeURIComponent(e.locale)),e&&e.acr&&(l+="&claims="+encodeURIComponent(JSON.stringify({id_token:{acr:e.acr}}))),(e&&e.acrValues||s.acrValues)&&(l+="&acr_values="+encodeURIComponent(e.acrValues||s.acrValues)),s.pkceMethod)try{let e=function(e,t){for(var o=function(e){if("undefined"==typeof crypto||void 0===crypto.getRandomValues)throw Error("Web Crypto API is not available.");return crypto.getRandomValues(new Uint8Array(96))}(96),r=Array(96),n=0;n<e;n++)r[n]=t.charCodeAt(o[n]%t.length);return String.fromCharCode.apply(null,r)}(96,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"),t=await f(s.pkceMethod,e);c.pkceCodeVerifier=e,l+="&code_challenge="+t+"&code_challenge_method="+s.pkceMethod}catch(e){throw Error("Failed to generate PKCE challenge.",{cause:e})}return a.add(c),l},s.logout=function(e){return i.logout(e)},s.createLogoutUrl=function(e){if("POST"===(e?.logoutMethod??s.logoutMethod))return s.endpoints.logout();var t=s.endpoints.logout()+"?client_id="+encodeURIComponent(s.clientId)+"&post_logout_redirect_uri="+encodeURIComponent(i.redirectUri(e,!1));return s.idToken&&(t+="&id_token_hint="+encodeURIComponent(s.idToken)),t},s.register=function(e){return i.register(e)},s.createRegisterUrl=async function(e){return e||(e={}),e.action="register",await s.createLoginUrl(e)},s.createAccountUrl=function(e){var t=h(),o=void 0;return void 0!==t&&(o=t+"/account?referrer="+encodeURIComponent(s.clientId)+"&referrer_uri="+encodeURIComponent(i.redirectUri(e))),o},s.accountManagement=function(){return i.accountManagement()},s.hasRealmRole=function(e){var t=s.realmAccess;return!!t&&t.roles.indexOf(e)>=0},s.hasResourceRole=function(e,t){if(!s.resourceAccess)return!1;var o=s.resourceAccess[t||s.clientId];return!!o&&o.roles.indexOf(e)>=0},s.loadUserProfile=function(){var e=h()+"/account",t=new XMLHttpRequest;t.open("GET",e,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Authorization","bearer "+s.token);var o=y();return t.onreadystatechange=function(){4==t.readyState&&(200==t.status?(s.profile=JSON.parse(t.responseText),o.setSuccess(s.profile)):o.setError())},t.send(),o.promise},s.loadUserInfo=function(){var e=s.endpoints.userinfo(),t=new XMLHttpRequest;t.open("GET",e,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Authorization","bearer "+s.token);var o=y();return t.onreadystatechange=function(){4==t.readyState&&(200==t.status?(s.userInfo=JSON.parse(t.responseText),o.setSuccess(s.userInfo)):o.setError())},t.send(),o.promise},s.isTokenExpired=function(e){if(!s.tokenParsed||!s.refreshToken&&"implicit"!=s.flow)throw"Not authenticated";if(null==s.timeSkew)return l("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var t=s.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+s.timeSkew;if(e){if(isNaN(e))throw"Invalid minValidity";t-=e}return t<0},s.updateToken=function(e){var t=y();if(!s.refreshToken)return t.setError(),t.promise;e=e||5;var o=function(){var o=!1;if(-1==e?(o=!0,l("[KEYCLOAK] Refreshing token: forced refresh")):(!s.tokenParsed||s.isTokenExpired(e))&&(o=!0,l("[KEYCLOAK] Refreshing token: token expired")),o){var r="grant_type=refresh_token&refresh_token="+s.refreshToken,n=s.endpoints.token();if(c.push(t),1==c.length){var i=new XMLHttpRequest;i.open("POST",n,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.withCredentials=!0,r+="&client_id="+encodeURIComponent(s.clientId);var a=new Date().getTime();i.onreadystatechange=function(){if(4==i.readyState){if(200==i.status){l("[KEYCLOAK] Token refreshed"),a=(a+new Date().getTime())/2;var e=JSON.parse(i.responseText);k(e.access_token,e.refresh_token,e.id_token,a),s.onAuthRefreshSuccess&&s.onAuthRefreshSuccess();for(var t=c.pop();null!=t;t=c.pop())t.setSuccess(!0)}else{p("[KEYCLOAK] Failed to refresh token"),400==i.status&&s.clearToken(),s.onAuthRefreshError&&s.onAuthRefreshError();for(var t=c.pop();null!=t;t=c.pop())t.setError(!0)}}},i.send(r)}}else t.setSuccess(!1)};return u.enable?_().then(function(){o()}).catch(function(e){t.setError(e)}):o(),t.promise},s.clearToken=function(){s.token&&(k(null,null,null),s.onAuthLogout&&s.onAuthLogout(),s.loginRequired&&s.login())};var I=function(){if(!(this instanceof I))return new I;function e(){for(var e=new Date().getTime(),t=0;t<localStorage.length;t++){var o=localStorage.key(t);if(o&&0==o.indexOf("kc-callback-")){var r=localStorage.getItem(o);if(r)try{var n=JSON.parse(r).expires;(!n||n<e)&&localStorage.removeItem(o)}catch(e){localStorage.removeItem(o)}}}}localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test"),this.get=function(t){if(t){var o="kc-callback-"+t,r=localStorage.getItem(o);return r&&(localStorage.removeItem(o),r=JSON.parse(r)),e(),r}},this.add=function(t){e();var o="kc-callback-"+t.state;t.expires=new Date().getTime()+36e5,localStorage.setItem(o,JSON.stringify(t))}},T=function(){if(!(this instanceof T))return new T;this.get=function(r){if(r){var n=t("kc-callback-"+r);if(o("kc-callback-"+r,"",e(-100)),n)return JSON.parse(n)}},this.add=function(t){o("kc-callback-"+t.state,JSON.stringify(t),e(60))},this.removeItem=function(t){o(t,"",e(-100))};var e=function(e){var t=new Date;return t.setTime(t.getTime()+6e4*e),t},t=function(e){for(var t=e+"=",o=document.cookie.split(";"),r=0;r<o.length;r++){for(var n=o[r];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""},o=function(e,t,o){var r=e+"="+t+"; expires="+o.toUTCString()+"; ";document.cookie=r}};function E(e){return function(){s.enableLogging&&e.apply(console,Array.prototype.slice.call(arguments))}}}}}]);